{"paragraphs":[{"text":"%pyspark\n\n# Checking Spark session\nspark","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.session.SparkSession object at 0x7f60fbdf58d0>\n"}]},"apps":[],"jobName":"paragraph_1546559718738_-1000247698","id":"20181006-150039_617173103","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3513"},{"text":"%pyspark\n\n df = spark.read.csv(\"s3://guanyuch/data/adult.data.csv\", header = True, inferSchema = True)","user":"anonymous","dateUpdated":"2019-01-03T23:55:50+0000","config":{"colWidth":12,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718739_2095447782","id":"20181006-150159_1903003763","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3514"},{"text":"%pyspark\n\ndf.show(5)","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-----------------+----------+---------------+-------------------+------------------+--------------+------+-------+------------+------------+--------------+--------------+------+\n|age|        workclass| education|education_years|     marital_status|        Occupation|  relationship|  race| gender|capital_gain|capital_loss|hours_per_week|       country|income|\n+---+-----------------+----------+---------------+-------------------+------------------+--------------+------+-------+------------+------------+--------------+--------------+------+\n| 39|        State-gov| Bachelors|             13|      Never-married|      Adm-clerical| Not-in-family| White|   Male|        2174|           0|            40| United-States| <=50K|\n| 50| Self-emp-not-inc| Bachelors|             13| Married-civ-spouse|   Exec-managerial|       Husband| White|   Male|           0|           0|            13| United-States| <=50K|\n| 38|          Private|   HS-grad|              9|           Divorced| Handlers-cleaners| Not-in-family| White|   Male|           0|           0|            40| United-States| <=50K|\n| 53|          Private|      11th|              7| Married-civ-spouse| Handlers-cleaners|       Husband| Black|   Male|           0|           0|            40| United-States| <=50K|\n| 28|          Private| Bachelors|             13| Married-civ-spouse|    Prof-specialty|          Wife| Black| Female|           0|           0|            40|          Cuba| <=50K|\n+---+-----------------+----------+---------------+-------------------+------------------+--------------+------+-------+------------+------------+--------------+--------------+------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1546559718739_-49303356","id":"20181006-151402_1627460008","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3515"},{"text":"%pyspark\n\ndf.printSchema()","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- age: integer (nullable = true)\n |-- workclass: string (nullable = true)\n |-- education: string (nullable = true)\n |-- education_years: integer (nullable = true)\n |-- marital_status: string (nullable = true)\n |-- Occupation: string (nullable = true)\n |-- relationship: string (nullable = true)\n |-- race: string (nullable = true)\n |-- gender: string (nullable = true)\n |-- capital_gain: integer (nullable = true)\n |-- capital_loss: integer (nullable = true)\n |-- hours_per_week: integer (nullable = true)\n |-- country: string (nullable = true)\n |-- income: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1546559718740_1388093196","id":"20181006-151511_686422731","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3516"},{"text":"%pyspark\n\ndf.columns","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['age', 'workclass', 'education', 'education_years', 'marital_status', 'Occupation', 'relationship', 'race', 'gender', 'capital_gain', 'capital_loss', 'hours_per_week', 'country', 'income']\n"}]},"apps":[],"jobName":"paragraph_1546559718740_-357988972","id":"20181006-151543_251340238","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3517"},{"text":"%pyspark\n\nselected_data = df.select(['age', 'race', 'gender', 'education_years', 'income'])\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718741_554187883","id":"20181006-151549_1374257480","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3518"},{"text":"%pyspark\n\nfinal_data = selected_data.na.drop()","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718741_-1626747978","id":"20181006-151656_852672015","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3519"},{"text":"%pyspark\n\nfinal_data.show(5)","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+------+-------+---------------+------+\n|age|  race| gender|education_years|income|\n+---+------+-------+---------------+------+\n| 39| White|   Male|             13| <=50K|\n| 50| White|   Male|             13| <=50K|\n| 38| White|   Male|              9| <=50K|\n| 53| Black|   Male|              7| <=50K|\n| 28| Black| Female|             13| <=50K|\n+---+------+-------+---------------+------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1546559718742_-1732805402","id":"20181006-151718_647913395","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3520"},{"text":"%pyspark\n\nfrom pyspark.ml.feature import VectorAssembler, OneHotEncoder, StringIndexer\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718742_-1169868083","id":"20181006-151726_1530873549","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3521"},{"text":"%pyspark\n\ngender_indexer = StringIndexer(inputCol = 'gender', outputCol = 'genderIndex')\ngender_encoder = OneHotEncoder(inputCol = 'genderIndex', outputCol = 'genderVector')","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718743_-1860752151","id":"20181006-151917_1770171429","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3522"},{"text":"%pyspark\n\nrace_indexer = StringIndexer(inputCol = 'race', outputCol = 'raceIndex')\nrace_encoder = OneHotEncoder(inputCol = 'raceIndex', outputCol = 'raceVector')","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718743_-138287628","id":"20181006-151923_1240961291","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3523"},{"text":"%pyspark\n\nincome_indexer = StringIndexer(inputCol = 'income', outputCol = 'label')\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718746_558035029","id":"20181006-151940_607957426","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3524"},{"text":"%pyspark\n\nassembler = VectorAssembler(inputCols = ['genderVector', 'raceVector', 'age', 'education_years'], outputCol = 'features')\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718746_-1253579772","id":"20181006-152011_806797138","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3525"},{"text":"%pyspark\n\nfrom pyspark.ml.classification import LogisticRegression","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718747_276404097","id":"20181006-152136_840541845","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3526"},{"text":"%pyspark\n\nlogistic = LogisticRegression(featuresCol = 'features', labelCol = 'label')","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718748_-1278560186","id":"20181006-152209_1226719340","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3527"},{"text":"%pyspark\n\nfrom pyspark.ml import Pipeline","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718748_-907846066","id":"20181006-152227_1109436848","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3528"},{"text":"%pyspark\n\npipeline = Pipeline(stages = [gender_indexer, race_indexer, gender_encoder, race_encoder, income_indexer ,assembler, logistic])","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718749_1202928977","id":"20181006-152241_739732546","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3529"},{"text":"%pyspark\n\ntrain_data, test_data = final_data.randomSplit([0.7, 0.3])\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718749_460680832","id":"20181006-152251_1426883760","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3530"},{"text":"%pyspark\n\nfit_model = pipeline.fit(train_data)\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718750_-1462635092","id":"20181006-152339_1864877224","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3531"},{"text":"%pyspark\n\nresults = fit_model.transform(test_data)\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718750_-926153455","id":"20181006-152351_1144461211","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3532"},{"text":"%pyspark\n\nresults.show(5)\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+------+-------+---------------+------+-----------+---------+-------------+-------------+-----+--------------------+--------------------+--------------------+----------+\n|age|  race| gender|education_years|income|genderIndex|raceIndex| genderVector|   raceVector|label|            features|       rawPrediction|         probability|prediction|\n+---+------+-------+---------------+------+-----------+---------+-------------+-------------+-----+--------------------+--------------------+--------------------+----------+\n| 17| Black| Female|              6| <=50K|        1.0|      1.0|    (1,[],[])|(4,[1],[1.0])|  0.0|(7,[2,5,6],[1.0,1...|[5.22004251569984...|[0.99462198025152...|       0.0|\n| 17| Black| Female|              6| <=50K|        1.0|      1.0|    (1,[],[])|(4,[1],[1.0])|  0.0|(7,[2,5,6],[1.0,1...|[5.22004251569984...|[0.99462198025152...|       0.0|\n| 17| Black| Female|              7| <=50K|        1.0|      1.0|    (1,[],[])|(4,[1],[1.0])|  0.0|(7,[2,5,6],[1.0,1...|[4.84977491284890...|[0.99223069493020...|       0.0|\n| 17| Black| Female|              7| <=50K|        1.0|      1.0|    (1,[],[])|(4,[1],[1.0])|  0.0|(7,[2,5,6],[1.0,1...|[4.84977491284890...|[0.99223069493020...|       0.0|\n| 17| Black|   Male|              5| <=50K|        0.0|      1.0|(1,[0],[1.0])|(4,[1],[1.0])|  0.0|[1.0,0.0,1.0,0.0,...|[4.32587588160152...|[0.98695057488286...|       0.0|\n+---+------+-------+---------------+------+-----------+---------+-------------+-------------+-----+--------------------+--------------------+--------------------+----------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1546559718751_557311060","id":"20181006-152448_67397011","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3533"},{"text":"%pyspark\n\nfrom pyspark.ml.evaluation import BinaryClassificationEvaluator, MulticlassClassificationEvaluator\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718751_1151174558","id":"20181006-152506_189318581","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3534"},{"text":"%pyspark\n\nmy_eval = BinaryClassificationEvaluator(labelCol = 'label')\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718752_-1012863492","id":"20181006-152718_623530846","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3535"},{"text":"%pyspark\n\nmy_eval.evaluate(results)","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.7999967866414486\n"}]},"apps":[],"jobName":"paragraph_1546559718752_1635795721","id":"20181006-152729_833796234","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3536"},{"text":"%pyspark\n\nfrom pyspark.ml.classification import DecisionTreeClassifier, RandomForestClassifier, GBTClassifier\n\n\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718753_1854751994","id":"20181006-152745_2051569773","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3537"},{"text":"%pyspark\n\ndtc = DecisionTreeClassifier(featuresCol = 'features', labelCol = 'label')\nrfc = RandomForestClassifier(numTrees = 100, featuresCol = 'features', labelCol = 'label')\ngbc = GBTClassifier(featuresCol = 'features', labelCol = 'label')\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718753_163661768","id":"20181006-153234_634556952","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3538"},{"text":"%pyspark\npipeline1 = Pipeline(stages = [gender_indexer, race_indexer, gender_encoder, race_encoder, income_indexer ,assembler, dtc])\npipeline2 = Pipeline(stages = [gender_indexer, race_indexer, gender_encoder, race_encoder, income_indexer ,assembler, rfc])\npipeline3 = Pipeline(stages = [gender_indexer, race_indexer, gender_encoder, race_encoder, income_indexer ,assembler, gbc])\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718754_1320619038","id":"20181006-153336_691185847","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3539"},{"text":"%pyspark\n\nfit_model1 = pipeline1.fit(train_data)\nfit_model2 = pipeline2.fit(train_data)\nfit_model3 = pipeline3.fit(train_data)","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718754_1688050113","id":"20181006-153446_806374970","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3540"},{"text":"%pyspark\n\nresults1 = fit_model1.transform(test_data)\nresults2 = fit_model2.transform(test_data)\nresults3 = fit_model3.transform(test_data)\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1546559718755_1793771234","id":"20181006-153530_1622000069","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3541"},{"text":"%pyspark\n\nmy_eval.evaluate(results1)","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.7656457582257752\n"}]},"apps":[],"jobName":"paragraph_1546559718755_552436142","id":"20181006-153847_2001896218","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3542"},{"text":"%pyspark\nmy_eval.evaluate(results2)","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.8237006333698829\n"}]},"apps":[],"jobName":"paragraph_1546559718756_-334582219","id":"20181006-153912_1704548206","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3543"},{"text":"%pyspark\nmy_eval.evaluate(results3)","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.8240326522328615\n"}]},"apps":[],"jobName":"paragraph_1546559718756_1231102156","id":"20181006-153918_1874177540","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3544"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-01-03T23:55:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1546559718757_244454870","id":"20181006-153926_1254694787","dateCreated":"2019-01-03T23:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3545"}],"name":"Learning Spark","id":"2E24WUNP7","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}